(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58177396"],{"12d4":function(t){t.exports=JSON.parse('["蝶恋花","龙争虎斗","长安城","幽月轮","斗转星移","剑胆琴心","乾坤一掷","唯我独尊","梦江南","绝代天骄","天鹅坪","破阵子","飞龙在天","眉间雪","山海相逢","傲血戰意","山海相逢","眉间雪"]')},"13d5":function(t,e,i){"use strict";var o=i("23e7"),a=i("d58f").left,s=i("a640"),r=i("1212"),n=i("9adc"),l=!n&&r>79&&r<83,c=l||!s("reduce");o({target:"Array",proto:!0,forced:c},{reduce:function(t){var e=arguments.length;return a(this,t,e,e>1?arguments[1]:void 0)}})},"40a4":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-lover-join m-lover-page wp"},[e("div",{staticClass:"u-page-title"},[e("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"join-title.png")}})]),t.joined?[e("div",{staticClass:"m-success"},[e("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"success.svg")}}),e("span",[t._v("报名成功，你的报名信息如下")])])]:t._e(),t.isLogin?[e("div",{staticClass:"m-lover-box m-lover-certificate"},[t.loverHasBind?e("certificate",{attrs:{data:t.loverNet}}):e("div",{staticClass:"no-certificate"},[t._v(" ღ 请先前往 "),e("a",{attrs:{href:"/dashboard/privacy?tab=lover"}}),t._v(" 绑定情缘哦~ ღ ")])],1),t.loverHasBind?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-lover-box m-lover-enroll"},[e("h3",[t._v("情缘杯报名")]),e("el-form",{ref:"form",class:["m-lover-form",{disabled:t.joined}],attrs:{disabled:t.joined,model:t.form,rules:t.rules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"队伍名",prop:"team_name"}},[e("el-input",{model:{value:t.form.team_name,callback:function(e){t.$set(t.form,"team_name",e)},expression:"form.team_name"}})],1),e("el-form-item",{attrs:{label:"战队图标"}},[t.joined?e("div",{staticClass:"u-image-list"},t._l(t.form.images,(function(t,i){return e("img",{key:i,staticClass:"u-image-item",attrs:{src:t}})})),0):e("uploadImage",{ref:"upload-image",on:{onFinish:t.onImageUploaded}})],1),e("el-form-item",{attrs:{label:"参赛宣言",prop:"slogan"}},[e("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.form.slogan,callback:function(e){t.$set(t.form,"slogan",e)},expression:"form.slogan"}})],1),e("el-form-item",{attrs:{label:"服务器",prop:"server"}},[e("el-select",{attrs:{placeholder:"请选择服务器"},model:{value:t.form.server,callback:function(e){t.$set(t.form,"server",e)},expression:"form.server"}},t._l(t.serverOptions,(function(i,o){return e("el-option",{key:o,attrs:{label:i.label,value:i.value}},[t._v(" "+t._s(i.label)+" ")])})),1)],1),e("el-form-item",{attrs:{label:"联系QQ",prop:"qq"}},[e("el-input",{model:{value:t.form.qq,callback:function(e){t.$set(t.form,"qq",e)},expression:"form.qq"}})],1),e("el-form-item",{attrs:{label:"联系电话",prop:"qq"}},[e("el-input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),e("el-form-item",{attrs:{label:"直播信息",prop:"live_id"}},[e("div",{staticClass:"u-live-form"},[e("el-select",{attrs:{"allow-create":"","default-first-option":"",filterable:"",placeholder:"直播平台"},model:{value:t.form.live_platform,callback:function(e){t.$set(t.form,"live_platform",e)},expression:"form.live_platform"}},[e("el-option",{attrs:{label:"斗鱼",value:"douyu"}}),e("el-option",{attrs:{label:"虎牙",value:"huya"}}),e("el-option",{attrs:{label:"B站",value:"bilibili"}}),e("el-option",{attrs:{label:"抖音",value:"douyin"}})],1),e("el-input",{attrs:{placeholder:"直播间地址"},model:{value:t.form.live_url,callback:function(e){t.$set(t.form,"live_url",e)},expression:"form.live_url"}})],1)])],1),e("div",{class:["u-submit",{disabled:t.joined}],on:{click:t.startUploadImage}},[e("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"join.png")}})])],1):t._e()]:e("div",{staticClass:"m-lover-box no-login"},[e("h3",[t._v("请登录后进行报名")]),e("div",{staticClass:"u-button",on:{click:t.toLogin}},[t._v("点击登录")])])],2)},a=[],s=i("5530"),r=(i("4de4"),i("d81d"),i("e9f5"),i("910d"),i("ab43"),i("d3b7"),i("12d4")),n=i("c9d2"),l=i("ead5"),c=i("85e4"),u=(i("a15b"),i("13d5"),i("9485"),function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{ref:"upload",attrs:{action:"https://cms.jx3box.com/api/cms/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:t.maxCount,accept:t.acceptedExtensions.reduce((function(t,e){return t+".".concat(e,",")}),""),multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[e("i",{staticClass:"el-icon-plus"}),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 最多上传 "+t._s(t.maxCount)+" 张 "+t._s(t.acceptedExtensions.join(" / ").toUpperCase())+" 格式图片，单张图片不能超过 "+t._s(t.maxSize/1024/1024)+" MB ")])]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)}),d=[],m=(i("99af"),i("a9e3"),{props:{fileMaxSize:{type:Number,default:10}},data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[],acceptedExtensions:["jpg","jpeg","png","gif"],maxCount:5,maxSize:1024*this.fileMaxSize*1024}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"最多上传 ".concat(this.maxCount," 张图片！"),type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,e){"ready"==t.status&&(t.size>this.maxSize?(this.$notify({title:"",message:"单张图片大小不能超过 ".concat(this.maxSize/1024/1024," MB！"),type:"error",duration:3e3,position:"bottom-right"}),e.pop()):this.fileList=e)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data),0===t.code?this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[]):this.onError(t.msg)},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]},addFile:function(t){return this.$refs.upload.handleStart(t),!1}}}),f=m,p=i("2877"),v=Object(p["a"])(f,u,d,!1,null,null,null),h=v.exports,g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-certificate"},[e("h3",{staticClass:"u-title"},[t._v("情缘证")]),e("div",{staticClass:"m-lover-users"},t._l(t.data.members,(function(i){return e("div",{key:i.id,staticClass:"m-lover-user"},[e("img",{staticClass:"u-avatar",attrs:{src:i.user_info.avatar||t.defaultAvatar}}),e("div",{staticClass:"u-name"},[t._v(t._s(i.user_info.display_name))])])})),0),e("h3",{staticClass:"u-days"},[t._v("结缘于 "+t._s(t.dayCount)+" 天前")])])},_=[],b=i("5a0c"),j=i.n(b),x={name:"certificate",props:{data:{type:Object,default:function(){}}},data:function(){return{}},computed:{defaultAvatar:function(){return"https://cdn.jx3box.com/image/common/avatar.png"},dayCount:function(){var t=this.data.members.reduce((function(t,e){var i=j()(e.created_at);return i.isAfter(t)?i:t}),j()(0));return-1*t.diff(j()(),"day")}},methods:{},mounted:function(){console.log(this.data)}},y=x,C=(i("d28f8"),Object(p["a"])(y,g,_,!1,null,null,null)),w=C.exports,L={name:"LoverJoin",inject:["__imgRoot"],components:{certificate:w,uploadImage:h},data:function(){return{loading:!1,list:[],form:{team_name:"",slogan:"",images:[],server:"",qq:"",phone:"",live_platform:"",live_url:""},rules:{team_name:[{required:!0,message:"请输入队伍名",trigger:"blur"}]},join_loading:!1}},computed:{serverOptions:function(){return r.map((function(t){return{value:t,label:t}}))},eventId:function(){return this.$store.getters.currentEventId},isLogin:function(){return n["a"].isLogin()},loverNet:function(){return this.$store.state.lover_net},loverHasBind:function(){var t,e,i;return this.loverNet&&(null===(t=this.loverNet)||void 0===t||null===(e=t.members)||void 0===e||null===(i=e.filter((function(t){return 1===t.status})))||void 0===i?void 0:i.length)>1},joinRecord:function(){return this.$store.state.join_record},joined:function(){return Boolean(this.joinRecord)},systemJoinParams:function(){return{event_id:this.eventId,user_id:n["a"].profile.ID,status:0,team_mates:this.loverNet.members.map((function(t){return t.user_id})),relation_net_id:this.loverNet.net.id,remark:null}}},watch:{},methods:{authorLink:c["a"],toLogin:function(){n["a"].toLogin()},startUploadImage:function(){if(!this.joined){var t=this.$refs["upload-image"];this.join_loading=!0,t.upload()}},onImageUploaded:function(t){this.form.images=t,this.toJoin()},toJoin:function(){var t=this,e=Object(s["a"])(Object(s["a"])({},this.systemJoinParams),this.form);Object(l["i"])(this.eventId,e).then((function(){t.$notify({title:"报名成功",type:"success"}),t.$store.dispatch("loadJoinRecord",{force:!0})})).finally((function(){t.join_loading=!1}))},initJoinForm:function(){var t=this;this.isLogin&&(this.joined?(this.form.team_name=this.joinRecord.team_name,this.form.slogan=this.joinRecord.slogan,this.form.images=this.joinRecord.images||[],this.form.server=this.joinRecord.server,this.form.qq=this.joinRecord.qq,this.form.phone=this.joinRecord.phone,this.form.live_platform=this.joinRecord.live_platform,this.form.live_url=this.joinRecord.live_url):Object(l["g"])().then((function(e){var i=e.data.data;t.form.server=i.jx3_server,t.form.phone=i.user_phone||"",t.form.qq=i.qq_number})))}},mounted:function(){this.initJoinForm()}},q=L,$=(i("aeaa"),Object(p["a"])(q,o,a,!1,null,null,null));e["default"]=$.exports},9485:function(t,e,i){"use strict";var o=i("23e7"),a=i("2266"),s=i("59ed"),r=i("825a"),n=i("46c4"),l=i("2a62"),c=i("f99f"),u=i("2ba4"),d=i("d039"),m=TypeError,f=d((function(){[].keys().reduce((function(){}),void 0)})),p=!f&&c("reduce",m);o({target:"Iterator",proto:!0,real:!0,forced:f||p},{reduce:function(t){r(this);try{s(t)}catch(d){l(this,"throw",d)}var e=arguments.length<2,i=e?void 0:arguments[1];if(p)return u(p,this,e?[t]:[t,i]);var o=n(this),c=0;if(a(o,(function(o){e?(e=!1,i=o):i=t(i,o,c),c++}),{IS_RECORD:!0}),e)throw new m("Reduce of empty iterator with no initial value");return i}})},aeaa:function(t,e,i){"use strict";i("d454")},bb71:function(t,e,i){},d28f8:function(t,e,i){"use strict";i("bb71")},d454:function(t,e,i){},d58f:function(t,e,i){"use strict";var o=i("59ed"),a=i("7b0b"),s=i("44ad"),r=i("07fa"),n=TypeError,l="Reduce of empty array with no initial value",c=function(t){return function(e,i,c,u){var d=a(e),m=s(d),f=r(d);if(o(i),0===f&&c<2)throw new n(l);var p=t?f-1:0,v=t?-1:1;if(c<2)while(1){if(p in m){u=m[p],p+=v;break}if(p+=v,t?p<0:f<=p)throw new n(l)}for(;t?p>=0:f>p;p+=v)p in m&&(u=i(u,m[p],p,d));return u}};t.exports={left:c(!1),right:c(!0)}}}]);