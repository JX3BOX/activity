(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b3e2bd0"],{"5a83":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-lover-draw",style:t.containerStyle},[e("div",{staticClass:"m-container"},[e("img",{staticClass:"m-title",attrs:{src:"".concat(t.cdnLink,"design/event/lover/draw_title.png"),alt:"title"}}),t._m(0),e("div",{staticClass:"m-draw-wrapper"},[e("video",{ref:"fire",staticClass:"m-fire",style:t.fireStyle,attrs:{autoplay:"",disablepictureinpicture:"",disableremoteplayback:"",loop:"",muted:"",playsinline:"",src:"".concat(t.cdnLink,"design/event/lover/fire.webm")},domProps:{muted:!0}}),e("div",{staticClass:"m-team-list"},[t._l(t.selectedTeams,(function(n,s){return e("div",{key:s,ref:"team",refInFor:!0,staticClass:"m-team-item",class:{"is-shuffle":n._is_shuffle},style:t.teamStyle(s)},[e("img",{staticClass:"u-icon",attrs:{src:n.images[0],alt:""}}),e("span",{staticClass:"u-name"},[t._v(t._s(n.team_name))]),e("div",{staticClass:"u-detail-btn"},[t._v("详 情")])])})),e("div",{staticClass:"u-anchor"})],2),t.groups.length?e("div",{staticClass:"m-group-list"},t._l(t.groups,(function(n,s){return e("div",{key:s,ref:"group",refInFor:!0,staticClass:"m-group-item",class:{"is-show-wrap":n.show,"is-selected":n.is_selected}},[e("img",{staticClass:"u-evil",attrs:{src:"".concat(t.cdnLink,"design/event/lover/vs_flame.png"),alt:""}}),e("img",{staticClass:"u-star",attrs:{src:"".concat(t.cdnLink,"design/event/lover/star1.png"),alt:""}}),e("img",{staticClass:"u-vs",attrs:{src:"".concat(t.cdnLink,"design/event/lover/vs.png"),alt:""}}),e("div",{staticClass:"m-group-teams"},t._l(n.teams,(function(n){return e("div",{key:n.id,staticClass:"m-group-team",attrs:{"data-id":n.id}},[e("img",{staticClass:"u-icon",attrs:{src:n.images[0],alt:""}}),e("span",{staticClass:"u-name"},[t._v(t._s(n.team_name))]),e("div",{staticClass:"u-detail-btn"},[t._v("详 情")])])})),0)])})),0):t._e()]),e("div",{staticClass:"m-actions"},[e("div",{staticClass:"u-draw-button",on:{click:t.onDraw}}),e("div",{staticClass:"u-reset-button",on:{click:t.onReset}})])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-subtitle"},[e("span",{staticClass:"u-title"},[t._v("说明")]),e("span",[t._v("共32支参赛队伍将被随机分为16组进行对决，首轮32进16采用BO1的单败赛制。")])])}],r=n("5530"),i=n("c14f"),c=n("1da1"),o=(n("99af"),n("c740"),n("caad"),n("d81d"),n("fb6a"),n("e9f5"),n("7d54"),n("ab43"),n("a732"),n("d3b7"),n("2532"),n("159b"),n("ead5")),u=n("2ef0"),l=function(t){return new Promise((function(e){return setTimeout(e,t)}))},f="https://oss.jx3box.com/",d={name:"",components:{},props:{},data:function(){return{cdnLink:f,selectedTeams:[],groups:[],step:0,currentGroupColumn:0,disableButton:!1,fire:{animation:!1,show:!1,left:0,top:0}}},computed:{events:function(){return this.$store.state.events},currentEvent:function(){return this.$store.state.event},containerStyle:function(){var t={"--background-image":"url(".concat(f,"design/event/lover/bg.webp)"),"--draw-image":"url(".concat(f,"design/event/lover/open0.png)"),"--draw-image-hover":"url(".concat(f,"design/event/lover/open1.png)"),"--reset-image":"url(".concat(f,"design/event/lover/reset.png)"),"--reset-image-hover":"url(".concat(f,"design/event/lover/reset_hover.png)")};return t},fireStyle:function(){return{"--fire-transition":this.fire.animation?"transform 0.7s ease":"none","--fire-opacity":this.fire.show?1:0,"--fire-left":"".concat(this.fire.left,"px"),"--fire-top":"".concat(this.fire.top,"px")}}},watch:{"$route.params.slug":{immediate:!0,handler:function(t){this.slug=t}},"currentEvent.id":{immediate:!0,deep:!0,handler:function(){this.loadTeams()}}},methods:{onDraw:function(){var t=this;return Object(c["a"])(Object(i["a"])().m((function e(){var n;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:if(!t.disableButton){e.n=1;break}return e.a(2);case 1:if(0!==t.step){e.n=4;break}return n=Object(u["shuffle"])(t.selectedTeams),t.groups=Object(u["chunk"])(n,2).map((function(t){return{is_selected:!1,show:!1,teams:t}})),t.selectedTeams=Object(u["sortBy"])(t.selectedTeams,(function(e){var n=t.groups.findIndex((function(t){return t.teams.includes(e)})),s=t.groups[n].teams.indexOf(e);return 2*n+s})),t.step=1,t.disableButton=!0,e.n=2,t.playStep1().finally((function(){t.disableButton=!1}));case 2:return e.n=3,l(500);case 3:t.onDraw(),e.n=10;break;case 4:if(1!==t.step){e.n=9;break}return t.disableButton=!0,e.n=5,t.playStep2().finally((function(){t.disableButton=!1,t.currentGroupColumn++}));case 5:if(4!==t.currentGroupColumn){e.n=6;break}t.step=2,e.n=8;break;case 6:return e.n=7,l(500);case 7:t.onDraw();case 8:e.n=10;break;case 9:2===t.step&&t.$confirm("确定保存并应用当前的抽签结果吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message({type:"success",message:"抽签结果已保存！(实际暂未)"})}));case 10:return e.a(2)}}),e)})))()},teamStyle:function(t){var e,n={};if(null!==(e=this.$refs.team)&&void 0!==e&&e.length){var s=this.$refs.team[t],a=this.selectedTeams[t],r=s.offsetLeft,i=s.offsetTop;if(a._left||a._top){var c=a._top,o=a._left;n["transform"]="translate(".concat(o-r,"px, ").concat(c-i,"px)")}return a._z&&(n["z-index"]=a._z),!1===a._show&&(n["opacity"]=0,n["pointer-events"]="none"),n}},playStep1:function(){var t=this;return Object(c["a"])(Object(i["a"])().m((function e(){return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return t.selectedTeams.forEach((function(e,n){t.$set(e,"_top",504),t.$set(e,"_left",500),t.$set(e,"_is_shuffle",!0)})),e.n=1,l(500);case 1:return t.selectedTeams.forEach((function(e,n){setTimeout(Object(c["a"])(Object(i["a"])().m((function n(){return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:return t.$set(e,"_top",324),n.n=1,l(100);case 1:t.$set(e,"_top",504);case 2:return n.a(2)}}),n)}))),25*n)})),e.n=2,l(1e3);case 2:return t.selectedTeams.forEach((function(e,n){setTimeout(Object(c["a"])(Object(i["a"])().m((function n(){return Object(i["a"])().w((function(n){while(1)switch(n.n){case 0:return t.$set(e,"_top",324),n.n=1,l(100);case 1:t.$set(e,"_top",504);case 2:return n.a(2)}}),n)}))),25*n)})),e.n=3,l(900);case 3:t.selectedTeams.forEach((function(e){var n=t.groups.findIndex((function(t){return t.teams.some((function(t){return t.id===e.id}))})),s=t.groups[n].teams.indexOf(e),a=32-2*n-s;t.$set(e,"_z",a),t.$set(e,"_is_shuffle",!1)})),t.selectedTeams.forEach((function(e){t.$set(e,"_top",564)}));case 4:return e.a(2)}}),e)})))()},playStep2:function(){var t=this;return Object(c["a"])(Object(i["a"])().m((function e(){var n,s;return Object(i["a"])().w((function(e){while(1)switch(e.n){case 0:return n=t.groups.slice(4*t.currentGroupColumn,4*t.currentGroupColumn+4),s=t.$refs.group[4*t.currentGroupColumn],t.fire.animation=!1,t.fire.left=s.offsetLeft,t.fire.top=0,n.forEach((function(e,n){setTimeout(Object(c["a"])(Object(i["a"])().m((function s(){var a;return Object(i["a"])().w((function(s){while(1)switch(s.n){case 0:return a=t.$refs.group[4*t.currentGroupColumn+n],e.teams.forEach((function(e){var n=a.querySelector('.m-group-team[data-id="'.concat(e.id,'"]')),s=a.offsetLeft+n.offsetLeft+1,r=a.offsetTop+n.offsetTop+1;t.$set(e,"_top",r),t.$set(e,"_left",s)})),s.n=1,l(500);case 1:e.is_selected=!0,e.show=!0,0===t.fire.top&&(t.fire.show=!0,t.fire.animation=!0,t.fire.top+=400,setTimeout((function(){t.fire.show=!1}),700)),e.teams.forEach((function(e){t.$set(e,"_show",!1)}));case 2:return s.a(2)}}),s)}))),200*n)})),e.n=1,l(700);case 1:return e.a(2)}}),e)})))()},onReset:function(){var t=this;this.selectedTeams=Object(u["sortBy"])(this.selectedTeams,"_index"),this.selectedTeams.forEach((function(e){t.$set(e,"_show",void 0),t.$set(e,"_top",void 0),t.$set(e,"_left",void 0),t.$set(e,"_z",void 0),t.$set(e,"_is_shuffle",void 0)})),this.currentGroupColumn=0,this.groups=[],this.step=0,this.fire={animation:!1,show:!1,left:0,top:0}},loadTeams:function(){var t=this;Object(o["j"])(this.currentEvent.id).then((function(e){t.selectedTeams=(e.data.data.list||[]).map((function(t,e){return Object(r["a"])({_index:e},t)})),console.log("Selected teams loaded:",t.selectedTeams)}))}}},m=d,p=(n("6247"),n("2877")),h=Object(p["a"])(m,s,a,!1,null,null,null);e["default"]=h.exports},6247:function(t,e,n){"use strict";n("9171")},9171:function(t,e,n){},a732:function(t,e,n){"use strict";var s=n("23e7"),a=n("c65b"),r=n("2266"),i=n("59ed"),c=n("825a"),o=n("46c4"),u=n("2a62"),l=n("f99f"),f=l("some",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:f},{some:function(t){c(this);try{i(t)}catch(s){u(this,"throw",s)}if(f)return a(f,this,t);var e=o(this),n=0;return r(e,(function(e,s){if(t(e,n++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},c740:function(t,e,n){"use strict";var s=n("23e7"),a=n("b727").findIndex,r=n("44d2"),i="findIndex",c=!0;i in[]&&Array(1)[i]((function(){c=!1})),s({target:"Array",proto:!0,forced:c},{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r(i)}}]);