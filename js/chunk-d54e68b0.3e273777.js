(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d54e68b0"],{"0c7c":function(t,e,s){},"17fd":function(t,e,s){"use strict";s("0c7c")},3153:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"events-page",class:{isMiniProgram:t.isMiniProgram},style:{backgroundImage:"url(".concat(t.getYearImgUrl("bg.jpg"),")")}},[e("div",{staticClass:"events-page__header"},[e("img",{staticClass:"events-page__header-title",attrs:{src:t.getImgUrl("title.png"),alt:"剑三年度大事件"}}),e("div",{staticClass:"events-page__header-year"},[e("img",{attrs:{src:t.getYearImgUrl("year.png"),alt:t.year}}),e("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{command:t.onChange}},[e("span",{staticClass:"u-change",on:{click:function(e){return e.stopPropagation(),t.clickChange.apply(null,arguments)}}}),t.changeVisible?t._e():e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.list,(function(s,a){return e("el-dropdown-item",{key:a,attrs:{command:s.year}},[e("span",[t._v(t._s(s.year))]),e("i",{staticClass:"el-icon-check"})])})),1)],1)],1)]),e("div",{staticClass:"events-page__content"},[e("div",{staticClass:"events-page__tip",domProps:{innerHTML:t._s(t.tip)}}),e("div",{staticClass:"events-page__scroll"},[e("img",{staticClass:"scroll__top",attrs:{src:t.getImgUrl("bg__top.png"),alt:"卷轴上端"}}),t.eventList.length?e("div",{staticClass:"m-table"},[t._m(0),e("div",{staticClass:"m-table__body"},[t.loading?e("div",{staticClass:"loading-state"},[t._v("加载中...")]):t._l(t.eventList,(function(s,a){return e("a",{key:a,staticClass:"scroll__item",attrs:{target:"_blank",href:t.postLink(s.link_user_id)}},[e("div",{staticClass:"item__rank"},[t._v(t._s(a+1))]),e("div",{staticClass:"item__content"},[e("div",{staticClass:"item__title"},[e("span",{staticClass:"title"},[t._v(t._s(s.title))]),s.sub_title?e("div",{staticClass:"u-tags"},t._l(s.sub_title.split("|"),(function(s){return e("span",{key:s,staticClass:"u-tag"},[t._v(" "+t._s(s)+" ")])})),0):t._e()]),e("p",{staticClass:"item__desc"},[t._v(t._s(s.content))])]),e("div",{staticClass:"item__stats"},[s.disabled?e("div",{staticClass:"u-btn u-btn--voted",on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[t._v(" 已投票 ")]):e("div",{staticClass:"u-btn u-btn--vote",on:{click:function(e){return t.vote(s,e)}}},[t._v(" 喜欢！吃瓜！ ")]),e("div",{staticClass:"u-count"},[t._v("人气: "+t._s(s.amount))])])])}))],2)]):e("div",{staticClass:"m-table"},[e("img",{attrs:{src:t.getImgUrl("null.png")}})]),e("img",{staticClass:"scroll__bottom",attrs:{src:t.getImgUrl("bg__bottom.png"),alt:"卷轴下端"}})])]),e("div",{staticClass:"events-page__character",class:{visible:t.isInMainContent}},[e("img",{attrs:{src:t.getImgUrl("pin.png"),alt:"吉祥物"}})]),e("div",{staticClass:"events-page__slogan",class:{visible:t.isInMainContent}},[e("img",{staticClass:"bigbang-title",attrs:{src:t.getYearImgUrl("slogan.png"),alt:"剑三年度大事件2024"}}),e("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{command:t.onChange}},[e("span",{staticClass:"u-change"}),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.list,(function(s,a){return e("el-dropdown-item",{key:a,attrs:{command:s.year}},[e("span",[t._v(t._s(s.year))]),e("i",{staticClass:"el-icon-check"})])})),1)],1)],1),e("el-drawer",{staticClass:"m-bigbang-drawer",attrs:{visible:t.changeVisible,direction:"btt","with-header":!1},on:{"update:visible":function(e){t.changeVisible=e}}},[e("div",{staticClass:"m-drawer"},[e("div",{staticClass:"u-item"},[t._v("切换年份")]),t._l(t.list,(function(s,a){return e("span",{key:a,staticClass:"u-item",class:{active:s.year===t.year},on:{click:function(e){return t.onChange(s.year)}}},[t._v(" "+t._s(s.year)+" ")])})),e("div",{staticClass:"u-item",on:{click:function(e){t.changeVisible=!1}}},[t._v("取消")])],2)])],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-table__header"},[e("span",{staticClass:"u-index"},[t._v("序号")]),e("span",{staticClass:"u-event"},[t._v("事件")]),e("span",{staticClass:"u-vote"},[t._v("我喜欢")])])}],n=(s("99af"),s("4de4"),s("caad"),s("d81d"),s("14d9"),s("e9f5"),s("910d"),s("7d54"),s("ab43"),s("d3b7"),s("2532"),s("159b"),s("cc9a")),o=s("2ef0"),c=s("41cb");function r(t){return Object(c["c"])().get("/api/next2/vote-program/program/".concat(t,"/public"))}function l(t,e){return Object(c["c"])().post("/api/next2/vote-program/program/".concat(t,"/vote"),e)}var d=s("65c2"),u=s("85e4"),g={name:"EventsPage",inject:["__imgRoot"],data:function(){return{list:[],showChange:!1,eventList:[],loading:!1,userStatus:[],voting:!1,isInMainContent:!1,tip:"踏入江湖，揭秘剑网3十大热门八卦！从深情告白到阵营风云，从副本黑幕到生活琐事，每一条都让你眼界大开。轻松一刻，尽在剑三八卦圈，大侠们，准备好瓜子，一起享受这场游戏界的八卦盛宴吧！",changeVisible:!1,isMiniProgram:Object(u["k"])()||Object(u["j"])()}},computed:{year:function(){return this.$route.query.year||"2025"},event_id:function(){var t,e=this;return(null===(t=this.list.filter((function(t){return t.year===e.year}))[0])||void 0===t?void 0:t.event_id)||""}},watch:{event_id:{handler:function(){this.loadData()},immediate:!0}},methods:{getImgUrl:function(t){return"".concat(this.__imgRoot,"common/").concat(t)},getYearImgUrl:function(t){return"".concat(this.__imgRoot).concat(this.year,"/").concat(t)},postLink:function(t){return d["__Root"]+"knowledge/view/"+t},showDecoration:function(){var t=this;return Object(o["debounce"])((function(){var e=window.scrollY,s=800;t.isInMainContent=e>s}),100)},onChange:function(t){this.$router.push({query:{year:t}}),this.showChange=!1,this.changeVisible=!1},loaMenu:function(){var t=this;Object(n["d"])("bigbang_data").then((function(e){t.list=e.map((function(t){return{year:t.year,event_id:t.event_id}}))}))},loadData:function(){var t=this;this.loading=!0,this.event_id?r(this.event_id).then((function(e){var s,a,i;t.eventList=(null===(s=e.data.data)||void 0===s?void 0:s.vote_items)||[],t.userStatus=(null===(a=e.data.data)||void 0===a||null===(i=a.latest_vote_history_record)||void 0===i?void 0:i.vote_item_id_list)||[],t.eventList.forEach((function(e){e.disabled=t.userStatus.includes(e.id)}))})).finally((function(){t.loading=!1})):(this.eventList=[],this.userStatus=[],this.loading=!1)},vote:function(t,e){var s=this;e.stopPropagation(),e.preventDefault(),l(this.event_id,{vote_id_list:[t.id]}).then((function(){s.$message.success("投票成功！"),t.amount+=1,t.disabled=!0}))},clickChange:function(){this.isMiniProgram&&(this.changeVisible=!0)}},mounted:function(){this.loaMenu(),window.addEventListener("scroll",this.showDecoration())}},v=g,_=(s("17fd"),s("2877")),m=Object(_["a"])(v,a,i,!1,null,null,null);e["default"]=m.exports}}]);