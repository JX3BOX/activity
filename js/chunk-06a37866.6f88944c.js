(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06a37866"],{4305:function(t,e,a){},"4e3b":function(t,e,a){"use strict";a("4305")},a68d:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-lover-vote wp"},[e("div",{staticClass:"u-page-title"},[e("img",{staticClass:"u-img",attrs:{src:"".concat(t.__imgRoot,"vote-title.png")}})]),e("div",{staticClass:"m-rule-box"},[e("h2",{staticClass:"u-rule-title"},[t._v("投票规则")]),e("div",{staticClass:"u-rule-icon"},[t._v("♡")]),e("div",{staticClass:"u-rule",domProps:{innerHTML:t._s(t.vote_note)}})]),e("div",{staticClass:"m-vote-list"},t._l(t.list,(function(a){return e("div",{key:a.id,staticClass:"m-vote-box",class:{"is-voted":a.voted},on:{mouseenter:function(e){return t.onMouseEnter(a.id)},mouseleave:function(e){return t.onMouseLeave(a.id)}}},[e("ParticleEffect",{ref:"particle-".concat(a.id),refInFor:!0}),e("div",{staticClass:"m-team-box"},[e("el-image",{staticClass:"u-team-img",attrs:{src:a.images[0]}},[e("i",{attrs:{slot:"error"},slot:"error"})]),e("div",{staticClass:"m-team-info"},[e("div",{staticClass:"u-team"},[t._v(t._s(a.team_name))]),e("div",{staticClass:"u-teammates"},t._l(t.uniqBy(a.teammeta_user_list,"id"),(function(a,s){return e("div",{key:s,staticClass:"u-teammate"},[e("el-image",{staticClass:"u-avatar",attrs:{src:t.showAvatar(a.avatar)}}),t._v(t._s(a.display_name)+" ")],1)})),0)])],1),e("div",{staticClass:"m-slogan-box"},[t._v(" 参赛宣言： "),e("div",{staticClass:"u-slogan"},[t._v(t._s(a.slogan))])]),e("div",{staticClass:"m-action-box"},[e("div",{staticClass:"u-hot"},[e("i",{staticClass:"u-hot-icon"},[t._v(t._s(a.voted?"♥":"♡"))]),t._v(" 人气值："+t._s(a.votes)+" ")]),e("div",{staticClass:"u-button",class:{voted:a.voted,disabled:t.vote_loading||a.voted},on:{click:function(e){return t.onVote(a)}}},[e("span",{staticClass:"u-text"},[t._v(t._s(a.voted?"已投票":"投票"))])])])],1)})),0)])},n=[],i=a("c14f"),o=a("1da1"),r=(a("e9f5"),a("7d54"),a("a732"),a("d3b7"),a("159b"),a("2ef0")),c=a("ead5"),u=a("c9d2"),d=a("85e4"),v=a("daef"),l={name:"LoverVote",inject:["__imgRoot"],components:{ParticleEffect:v["a"]},data:function(){return{pageSize:30,index:1,list:[],total:0,vote_loading:!1,loading:!1}},computed:{eventId:function(){return this.$store.getters.currentEventId},event:function(){return this.$store.state.event},vote_note:function(){return this.$store.state.event.vote_note},params:function(){return{pageSize:this.pageSize,index:this.index}},uid:function(){return u["a"].getInfo().uid},isLogin:function(){return u["a"].isLogin()}},watch:{params:{deep:!0,immediate:!0,handler:function(){this.load()}}},methods:{uniqBy:r["uniqBy"],showAvatar:d["n"],load:function(){var t=this;this.loading=!0,Object(c["j"])(this.eventId).then((function(e){t.list=e.data.data.list||[],t.loading=!1,t.isLogin&&Object(c["h"])({user_id:t.uid,event_id:t.eventId}).then((function(e){var a=e.data.data.list||[];t.list.forEach((function(e){var s=a.some((function(t){return t.record_id===e.id}));t.$set(e,"voted",s)}))}))}))},onVote:function(t){var e=this;return Object(o["a"])(Object(i["a"])().m((function a(){var s,n,o,r,u,d,v,l,f,m;return Object(i["a"])().w((function(a){while(1)switch(a.p=a.n){case 0:if(!e.vote_loading){a.n=1;break}return a.a(2);case 1:return e.vote_loading=!0,a.p=2,o=e.event.is_point_vote?Object(c["o"])(e.eventId,t.id,{votes_count:10}):Object(c["o"])(e.eventId,t.id,{votes_count:0}),a.n=3,o;case 3:if(r=a.v,u=null===(s=r.data)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.id,!e.event.is_point_vote){a.n=10;break}if(u){a.n=4;break}return e.$message.error("投票失败，请稍后再试"),a.a(2);case 4:d=0;case 5:if(!(d<10)){a.n=9;break}return a.n=6,new Promise((function(t){return setTimeout(t,500)}));case 6:return a.n=7,Object(c["k"])(e.eventId,t.id,u);case 7:if(f=a.v,m=null===(v=f.data)||void 0===v||null===(l=v.data)||void 0===l?void 0:l.status,!m){a.n=8;break}return e.$message.success("投票成功"),t.votes+=1,t.voted=!0,a.a(3,9);case 8:d++,a.n=5;break;case 9:a.n=11;break;case 10:e.$message.success("投票成功"),t.votes+=1,t.voted=!0;case 11:return a.p=11,e.vote_loading=!1,a.f(11);case 12:return a.a(2)}}),a,null,[[2,,11,12]])})))()},onMouseEnter:function(t){var e=this.$refs["particle-".concat(t)];e&&e[0]&&e[0].playAnimation()},onMouseLeave:function(t){var e=this.$refs["particle-".concat(t)];e&&e[0]&&e[0].stopAnimation()}}},f=l,m=(a("4e3b"),a("2877")),_=Object(m["a"])(f,s,n,!1,null,null,null);e["default"]=_.exports},a732:function(t,e,a){"use strict";var s=a("23e7"),n=a("c65b"),i=a("2266"),o=a("59ed"),r=a("825a"),c=a("46c4"),u=a("2a62"),d=a("f99f"),v=d("some",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:v},{some:function(t){r(this);try{o(t)}catch(s){u(this,"throw",s)}if(v)return n(v,this,t);var e=c(this),a=0;return i(e,(function(e,s){if(t(e,a++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}}]);